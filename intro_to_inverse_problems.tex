\documentclass[12pt]{article}
\RequirePackage[l2tabu, orthodox]{nag}
\usepackage[main=english]{babel}
\usepackage[rm={lining,tabular},sf={lining,tabular},tt={lining,tabular,monowidth}]{cfr-lm}
\usepackage{amsthm,amssymb,latexsym,gensymb,mathtools,mathrsfs}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[pdftex]{graphicx}
\usepackage{epstopdf,enumitem,microtype,dcolumn,booktabs,hyperref,url,fancyhdr}

% Plotting
\usepackage{pgfplots}
\usepackage{xinttools} % for the \xintFor***
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.8}
\usepackage{tikz}

% Custom Commands
\newcommand*{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand*{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand*{\suchthat}{\,\mathrel{\big|}\,}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Img}{\mathrm{Img}}
\newcommand{\Ker}{\mathrm{Ker}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Prob}{\mathbb{P}}
\DeclarePairedDelimiterX\innerp[2]{(}{)}{#1\delimsize\vert\mathopen{}#2}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

\setlist{topsep=1ex,parsep=1ex,itemsep=0ex}
\setlist[1]{leftmargin=\parindent}
\setlist[enumerate,1]{label=\arabic*.,ref=\arabic*}
\setlist[enumerate,2]{label=(\alph*),ref=(\alph*)}

% Specifically for paper formatting 
\renewcommand{\baselinestretch}{1.2} % Spaces manuscript for easy reading

% Formatting definitions, propositions, etc. 
\newtheorem*{definition}{Definition}
\newtheorem*{prop}{Proposition}


\begin{document}

\begin{center}
\Large
A Brief Introduction to Linear Inverse Problems in Hilbert Space
\end{center}

\begin{flushright}
Andrew Roberts
\end{flushright} 

The study of inverse problems is generally concerned with approximating 
an unknown value using potentially corrupted or noisy data. The study of 
such problems finds many applications across the physical, social, and 
mathematical sciences. 

This document is meant to help you prepare an Article for
submission to \textsc{Mathematics Magazine}.  Of course,
editorial decisions depend entirely on
what you say and how you say it. Nonetheless, we will all save
time if you exercise some care in how you first present the paper.

Now that I have caught your attention with an interesting introductory paragraph,
here is what you will find:
specific information about the style of Articles in the \textsc{Magazine}
and a description of the \LaTeX\ code we prefer that you use
to prepare your manuscript.

Since this section is very clearly
an introduction, I thought that labeling it ``Introduction" would add
nothing.  Note that I am willing to use the first person in an Article
and you might be as well.  Another equally respectable choice is ``we,''
even when there is only one author; this can
create an author-reader partnership to
work through the mathematics together.
Whatever voice you choose, consistency is important.


\section{Introduction to Inverse Problems} 

\subsection{Motivation}
Students of linear algebra may recall the prominence of the matrix equation
\begin{equation} 
Ax = b. \label{matrix_eqn}
\end{equation}  
Here we may consider $A$ as a linear map 
that acts on a given vector $x$ and produces the output vector $b$. 
This constitutes the ``forward problem'' in which we are given inputs and must 
calculate outputs. The corresponding ``inverse problem'' reverses the situation; we observe 
$b$ and must determine the input $x$ which produced it. In its simplest form we may assume 
$A$ is invertible, in which case the solution to the inverse problem is given by matrix 
inversion: $x = A^{-1}b$. This paper introduces a vast generalization of this inverse 
problem framework, shedding the simplifying assumptions of finite dimensionality
and invertibility. The motivation for such a general theory 
of inverse problems will become clear with examples, as the majority of interesting 
applications fail to enjoy the ``well-posedness'' of the above equation. 
To make these notions concrete, consider the following mapping:
\begin{eqnarray} 
&F: X \to Y \\
&F(x) = y \label{inverse_problem}
\end{eqnarray} 
This equation, which generalizes the above matrix equation, will constitute the primary subject 
of our analysis. The goal remains to compute $x$ given $y$. Note that I have been intentionally 
vague regarding specific properties of the map $F$ or spaces $X$ and $Y$. Indeed, varying the assumptions 
placed on these objects lead to drastically different avenues of analysis and conceptual interpretations
of inverse problems. 

\subsection{Ill-Posedness}

If all real-world examples of inverse problems admitted straightforward representations as in equation \eqref{matrix_eqn}
then the field of inverse problem theory would not exist. The essence of the field is in developing methods to 
deal with the so-called ``ill-posed'' cases. The following definition makes this notion concrete, 
and motivates much of the theory discussed in this paper. 

\begin{definition} 
(Hadamard's Conditions)The inverse problem given by equation \eqref{inverse_problem} is well-posed in the sense of Hadamard 
provided it satisfies the three following conditions:
\begin{enumerate} 
\item (Existence) A solution always exists; that is, given any $y \in Y$ there exists an $x \in X$ such that $F(x) = y$. 
\item (Uniqueness) The solution is unique; that is, if $F(x_1) = F(x_2)$ then $x_1 = x_2$.
\item (Stability) The solution is a continuous function of the input data; that is, if $F(x_n) \to y$  then $x_n \to x$
\end{enumerate} 
If any of these conditions are not met, the problem is called ill-posed. 
\end{definition} 

Given that the central task in studying inverse problems is to mitigate ill-posedness, it is worthwhile to make some comments here. 
Violations of the first two conditions are typically handled by 
instead seeking the ``closest'' solution in some sense; that is, by reformulating the problem as a minimum norm problem: 

\begin{equation}
\argmin_{x \in X} \norm{F(x) - y} \label{min_norm}
\end{equation}

 The violation of stability presents a more difficult challenge. In general we imagine $y$ to be data measured imprecisely. 
 Therefore, the concern is that small fluctuations in the observations $y$ may lead to large deviations in $x$. 
Our goal is to minimize the \textit{forward error} $\norm{x - x_0}$, where $x_0$ is some unknown true solution. However, 
given that we don't know $x_0$, we must instead focus our efforts on minimizing the \textit{backward error}, $\norm{F(x) - y}$. 
Stated in this terminology, the stability condition means that small backward errors imply small forward errors. 

 Regularization methods form the foundation of the toolkit used to address instability and will be discussed later in this paper. 

\subsection{Theoretical Framework}

Hilbert space provides a natural setting in which to study inverse problems. From a theoretical point of view, the structure provided by 
inner products leads to relatively simple characterizations of solutions, while practically, many real-world inverse problems may 
naturally be formulated in such settings. Therefore, throughout this paper, we consider the inverse problem \eqref{inverse_problem}
where $X$ and $Y$ are assumed to be real Hilbert spaces with respective inner products $(\cdot | \cdot)_X$ and $(\cdot | \cdot)_Y$. 
Moreover, we assume $F$ to be a bounded linear operator between these spaces. 

It is important to note that while we have restricted ourselves to these assumptions, inverse problems can be formulated in many 
other settings. Perhaps the most notable omission here is any sort of statistical treatment. It is common to treat $X$ and $Y$ as
probability spaces and $x$ and $y$ as random variables. In this setting, the given ``data'' is the conditional random variable 
$y|x$, and solving the inverse problem means estimating the random variable $x|y$. While such a formulation is common, this 
paper will treat the solution of \eqref{inverse_problem} as purely deterministic.  

 \subsection{Examples}
 
 An abstract, general formulation of inverse problems may not initially appear useful. 
 However, it soon becomes clear that the generality allows these techniques to be 
 applied to a wide array of problems across various fields. Many of these applications 
 are naturally formulated in infinite-dimensional vector spaces, and moreover suffer from
  ill-posedness. I provide three examples below of such applications. 
 
 \paragraph*{Statistical Estimation}
 Parameter estimation (or \textit{model calibration}), ubiquitous across the fields of statistics 
 and machine learning, may be formulated as an inverse problem. In this case we view 
 $F_\theta$ as a model or process that depends on some parameters $\theta$. We may
  alternatively view $\theta$ as an additional input to the system, in which case $F$ acts 
  on both the parameters and input data to produce the observed outputs; that is, 
  $F(\theta, x) = y$. The problem thus becomes: given observed outputs $y$ and inputs $x$, 
  estimate the parameters $\theta$ of the underlying process $F$. 
  
  \paragraph*{Differentiation}
 
 \textbf{TODO: Add two more examples}
 
 
 \section{Preliminaries: Operator Theory}
 This paper assumes prior knowledge of Hilbert spaces, including the basic theory of bounded 
 linear maps between such spaces. However, the adjoint operator, which is of central importance 
 to the study of inverse problems, is treated from scratch. As a notational note, $B(X, Y)$ denotes the space of all bounded
 (or equivalently, continuous) linear operators from $X$ to $Y$. For $F \in B(X, Y)$ we write $\norm{F}$
 to refer to the operator norm of $F$. $\mathcal{R}(F)$ and $\mathcal{N}(F)$ refer to the range and 
 null space of $F$, respectively.  
 
 With this notation established, we may introduce a key operator in inverse problem theory. 
 \begin{definition} 
 (Adjoint) Let $F \in B(X, Y)$. Then the adjoint operator of $F$, $F^*: Y \to X$, is defined by 
 	\begin{equation*} 
	(Ax|y)_Y = (x|A^*y)_X
 	\end{equation*} 
	for all $x \in X$, $y \in Y$. 
 \end{definition} 
To justify this definition, consider the bounded linear functional $f_y(x) = (Ax|y)_Y$. By the Riesz representation theorem (Royden) 
there is a unique $x_y \in X$ satisfying $f_y(x) = (x|x_y)_X$ for all $x \in X$; that is, $(Ax|y)_Y = (x|x_y)_X$. 
We thus define $A^*y := x_y$. The adjoint helps to encode orthogonality relations between the spaces $X$ and $Y$. 
It may be interpreted as a generalization of the transpose operator for real-valued matrices; indeed, if $A \in \mathbb{R}^{n \times m}$, 
then $A^* = A^\prime$. The following three propositions outline the fundamental properties of adjoints that will leveraged throughout
this paper. 

\begin{prop} 
Let $F \in B(X, Y)$. Then $F^* \in B(Y, X)$ and $\norm{F^*} = \norm{F}$. 
\end{prop}

\begin{proof} 
The linearity of $F^*$ follows directly from the definition of the adjoint and the linearity of the inner product. 
\begin{align*} 
(x|F^*(\alpha_1 y_1 + \alpha_2 y_2))_X &= (Fx|\alpha_1 y_1 + \alpha_2 y_2)_Y \\
                                                               &= \alpha_1(Fx|y_1)_Y + \alpha_2(Fx|y_2)_Y \\
                                                               &= \alpha_1(x|F^*y_1)_X + \alpha_2(x|F^*y_2)_X \\
                                                               &= (x|\alpha_1 F^*y_1 + \alpha_2 F^*y_2)_X
\end{align*} 
To show that $F^*$ is bounded, let $y \in Y$ be non-zero and apply the Cauchy-Schwarz inequality to obtain,
\begin{align*} 
\norm{F^*y}^2_X = (F^*y|F^*y)_X = (F(F^*y)|y)_Y &\leq \norm{F(F^*y)}_Y\norm{y}_Y \\
                                                                               &\leq \norm{F}\norm{F^*y}_X\norm{y}_Y
\end{align*}
Thus, $\norm{F^*y}_X \leq \norm{F}\norm{y}_Y$ for all non-zero $y \in Y$ and therefore $\norm{F^*} \leq \norm{F}$. 
This verifies $F^* \in B(Y, X)$. By similar reasoning, we obtain the reverse inequality. 
\begin{align*} 
\norm{Fx}^2_Y = (Fx|Fx)_Y = (x|F^*(Fx))_X &\leq \norm{F^*(Fx)}_X\norm{x}_X \\
                                                                      &\leq \norm{F^*}\norm{Fx}_Y\norm{x}_X
\end{align*}
Therefore, $\norm{Fx} \leq \norm{F^*}\norm{x}_X$ for all non-zero $x \in X$ and so $\norm{F} \leq \norm{F^*}$. 
Thus, $\norm{F} = \norm{F^*}$
\end{proof} 

The first two results in the following proposition tell us that the adjoint is a linear map from $B(X, Y)$
to $B(Y, X)$.

\begin{prop} 
Let $F, G \in B(X, Y)$ and $\alpha \in \mathbb{R}$. Then,
\begin{itemize}
\item $(F + G)^* = F^* + G^*$
\item $(\alpha F)^* = \alpha F^*$
\item $F^{**} = F$
\end{itemize}  
\end{prop}

\begin{proof} 
The first result follows from definition of adjoint and linearity of the inner product. 
\begin{align*} 
(x|(F + G)^*y) &= ((F + G)x|y) \\
                       &= (Fx|y) + (Gx|y) \\
                       &= (x|F^*y) + (x|G^*y) \\
                       &= (x|F^*y + G^*y)
\end{align*} 
Since $x$ and $y$ are arbitrary, this shows $(F + G)^* = F^* + G^*$. The second result follows from the 
same line of reasoning. For the third result, we know $F^{**}: X \to Y$ so 
\begin{equation*} 
(F^{**}x|y) = (x|F^*y) = (Fx|y)
\end{equation*} 
which shows $F^{**} = F$.
\end{proof} 

Recall from linear algebra that if $A \in \mathbb{R}^{n x m}$, then the row space of $A$ is orthogonal to 
the null space, and similarly the column space is orthogonal to the null space of $A^\prime$. The following
result generalizes this idea to Hilbert space, replacing the transpose with the adjoint. 

\begin{prop} 
Let $F \in B(X, Y)$. Then, 
\begin{itemize} 
\item $\mathcal{R}(F)^\perp = \mathcal{N}(F^*)$
\item $\overline{\mathcal{R}(F)} = \mathcal{N}(F^*)^\perp$
\item $\mathcal{R}(F^*)^\perp = \mathcal{N}(F)$
\item $\overline{\mathcal{R}(F^*)} = \mathcal{N}(F)^\perp$
\end{itemize} 
\end{prop} 


To conclude our introduction to the adjoint, we prove a result that more closely aligns with our goal of studying 
linear inverse problems. The restrictive assumption that the equation is consistent will be dropped in section
\textbf{section num}, where this result will be generalized to least-squares problems. 



\section{Linear Inverse Problems in Hilbert Space}

 Recall from section \textbf{2} that the natural approach to address the non-existence and non-uniqueness of $Tx = y$ was to consider the least-squares problem $\inf_{x \in X} \norm{Tx - y}_Y$. If we assume that $\Img T \subset Y$ is closed, this guarantees the existence of a unique $\hat{y} \in Y$ minimizing $\norm{y^\prime - y}_Y$ on $\Img T$. However, we have not assumed that $T$ is injective and hence this does not imply the uniqueness of a least-squares solution. Therefore, we must study the set of all least-squares solutions, with an emphasis on the solution of minimal norm. 

\subsection{Characterization of Solutions}

 \textbf{Definition} (generalized solutions): 
 \begin{itemize}
 \item $x \in X$ is called a \textit{least-squares solution} of 1.1 if $\norm{Tx - y}_Y \leq \norm{Tu - y}_Y$ for all $u \in X$. $\mathbb{L}$ denotes the set of all such solutions. 
 \item $x^\dagger \in X$ is called a \textit{minimal norm least-squares solution} if $x^\dagger \in \mathbb{L}$ and $\norm{x^\dagger}_X \leq \norm{x}_X$ for all $x \in \mathbb{L}$. 
 \end{itemize} 
 
 Note that in general $\mathbb{L}$ may be empty. The following assumption relies on the assumption that $\Img T$ is closed to ensure the existence of a solution. 
 
 \textbf{Proposition}: Suppose $\Img T$ is closed. Then there is a unique minimal norm least-squares solution $x^\dagger$. Moreover, $x^\dagger \in (\Ker T)^\perp$. \\[.1cm]
 
 \textit{Proof}: Since $\Img T$ is closed, then there exists a unique $\hat{y} \in Y$ satisfying $\hat{y} = \min_{y^\prime \in \Img T} \norm{y^\prime - y}_{Y}$. Let $\hat{x} \in \mathbb{L}$ such that $T\hat{x} = \hat{y}$. Then, 
 \begin{align*} 
 \mathbb{L} &= \{x \in X: Tx = \hat{y}\} \\
                   &= \{x \in X: T(x - \hat{x}) = 0\} \\
                   &= \hat{x} + \{x - \hat{x} \in X: T(x - \hat{x}) = 0\} \\
                   &= \hat{x} + \Ker T
 \end{align*}  
 
 Therefore, $ \mathbb{L}$ is a translation of the closed subspace $\Ker T$. It then follows immediately from Luenberger 3.10 Theorem 3 that there exists a unique $x^\dagger \in \mathbb{L}$ of minimal norm, and moreover that $x^\dagger$ is orthogonal to $\Ker T$. $\qquad \blacksquare$
 
 While the above proof is illustrative, the assumption that $\Img T$ is closed is too restricting in some applications (\textbf{add example}). Fortunately, loosening this restriction does not forfeit the uniqueness of the minimal norm solution. However, it does require the additional assumption that a least-squares solution exists at all. 
 
 \textbf{Proposition}: Suppose $\mathbb{L}$ is non-empty. Then the results of the above proposition still hold. 
 \textbf{NEED TO VERIFY THIS IS ACTUALLY TRUE: SEE EL THM 2.2; I believe it is true and I can use Thm 2.2 and the following corollary to prove it}
 \textit{Proof}: (EL) Let $x^\dagger$ be a minimal norm solution and suppose for a contradiction that $x^\dagger \notin \Ker T$. Since $\Ker T$ is a closed subspace then $X = \Ker T \oplus (\Ker T)^\perp$. Thus, there exists unique vectors $u \in \Ker T$ and $u^\perp \in (\Ker T)^\perp$ satisfying $x^\dagger = u + u^\perp$. Since $\norm{Tu^\perp - y}_X = \norm{T(x - u) - y}_X = \norm{Tx - y}_X$, it follows that $u^\perp \in \mathbb{L}$. Then, \[\norm{x^\perp}_{X}^{2} = \norm{u + u^\perp}_{X}^{2} = \norm{u}_{X}^{2} + \norm{u^\perp}_{X}^{2} > \norm{u^\perp}_{X}^{2}\]
 which contradicts $x^\dagger$ being a minimal norm solution. 
 
 \smallskip 
 
\textbf{Must show existence} 

\medskip

The following theorem generalizes the well-known normal equations to infinite-dimensional spaces. 

\textbf{Theorem}: $\hat{x} \in \mathbb{L}$ if and only if $T^* T\hat{x} = T^* y$. In this case $T\hat{x} - y \in (\Img T)^\perp$. \\[.1cm] 

\textit{Proof}: (L and S) First note that $\inf_{x \in X} \norm{Tx - y}_Y = \inf_{y^\prime \in \Img T} \norm{y^\prime - y}_Y$. By the projection theorem (Luenberger 3.3 Theorem 1) we have \[\hat{y} = \inf_{y^\prime \in \Img T} \norm{y^\prime - y}_Y \iff \hat{y} - y \perp \Img T\] 
The orthogonality condition follows from the fact that $\hat{x} \in \mathbb{L}$ if and only if $T\hat{x} = \hat{y}$. 

\smallskip

To obtain the normal equations, consider: 
\begin{align*} 
\hat{x} = \inf_{x \in X} \norm{Tx - y}_X &\iff (T\hat{x} - y) \perp \Img T \\
                                                            &\iff (T\hat{x} - y| Tx) = 0 \ \forall x \in X \\
                                                            &\iff (T^*(T\hat{x} - y)| x) = 0 \ \forall x \in X \\
                                                            &\iff (T^*T\hat{x} - T^*y| x) = 0 \ \forall x \in X \\
                                                            &\iff T^*T\hat{x} - T^*y = 0 \\
                                                            &\iff T^*T\hat{x} = T^*y                                                            
\end{align*} 
where the first step uses the above portion of the proof and the remainder utilize the basic properties of the adjoint and inner product. $\qquad \blacksquare$
 
 \subsection{Finding Minimal Norm Solutions} \hfill \\
 
 In the above section, we verified (under suitable assumptions) the existence of a unique minimal norm solution. We now turn our attention to developing techniques to find this solution. The standard tool in this effort is the \textit{Moore-Penrose pseudoinverse}. As we are not guaranteed a unique least-squares solution, the standard concept of an ``inverse'' does not apply. However, we now observe the utility of having proved results that guarantee a unique minimal norm solution, which allows us to generalize the inverse as an operator that maps to such solutions. 
 
 \textbf{Definition}: For $T \in B(X, Y)$, define $\tilde{T}$ to be the restriction of $T$ to $(\Ker T)^\perp$. The \textit{Moore-Penrose psuedoinverse} $T^\dagger : (\Img T) \oplus (\Img T)^\perp \to Y$ is then defined as follows: 
 \begin{itemize} 
 \item For all $y \in \Img T$, $T^\dagger y := T^{-1}y$
 \item $T^\dagger$ is extended to $(\Img T) \oplus (\Img T)^\perp$ by requiring that $T^\dagger$ is linear and satisfies $T^\dagger y^\perp = 0$ for all $y^\perp \in (\Img T)^\perp$
 \end{itemize} 
 
Note that by definition $\tilde{T}$ has a trivial null space and we are therefore justified in talking about its inverse. Recall from \textbf{prop num} that the requirement $y \in (\Img T) \oplus (\Img T)^\perp$ guaranteed uniqueness of the minimal norm solution. It is therefore unsurprising that we define the domain of $T^\dagger$ to be $(\Img T) \oplus (\Img T)^\perp$. In particular, if $\Img T$ is closed then $T^\dagger$ is defined on all of $Y$. While the above definition may seem cryptic, the next result shows that it addresses our problem of finding minimal norm solutions.

\textbf{Proposition}: Let $y \in (\Img T) \oplus (\Img T)^\perp$. Then $T^\dagger y$ is the minimal norm solution of the least-squares problem. 

\smallskip 

\textit{Proof}: By \textbf{prop num}, a unique minimal norm solution exists. There are unique $\hat{y} \in \Img T$ and $y^\perp \in (\Img T)^\perp$ such that $y = \hat{y} + y^\perp$. Since $y - \hat{y} \perp \Img T$ it follows from the projection theorem (Luenberger 3.3 Theorem 1) that $\hat{y} = \argmin_{y^\prime \in \Img T} \norm{y^\prime - y}_Y$. By definition of $T^\dagger$, we have \[T^\dagger y = T^\dagger \hat{y} = \tilde{T}^{-1}\hat{y}\]
 Applying $T$ to both sides, \[T(T^\dagger y) = \hat{y}\]
 Thus $T^\dagger y \in \mathbb{L}$. By definition $T^\dagger y \in (\Ker T)^\perp$ so $T^\dagger y$ is the minimal norm solution (\textbf{prop num}). $\qquad \blacksquare$
 
 
 
 
 
 
 

\end{document} 